<div class="container">
  <div class="jumbotron">
    <h1>Time Tracker</h1>
  </div>

  <!-- Debut Quick task -->
  <div class="jumbotron">
    <button class="btn btn-success"
            type="submit" (click)="onQuickStart()">Quick start
    </button>
  </div>
  <!--  Fin Quick task -->

  <!--  Debut formulaire pour creer une tache/categorie -->
  <div class="input-group mb-3">
    <form [formGroup]="saveForm" (ngSubmit)="onSave()">
      <div class="form-row">

        <div class="form-group col">
          <label for="type">Ajouter </label>
          <select class="form-control" name="type" id="type" formControlName="type" #t>
            <option value="tache"> tache </option>
            <option value="categorie"> categorie </option>
          </select>
        </div>

        <div class="form-group col" *ngIf="t.value !== 'categorie'">
          <label for="parent"> à </label>
          <select class="form-control" name="parent" id="parent" formControlName="parent"> <!--[value]="'Single tasks'"-->
            <option *ngFor="let categorie of categories | slice:1; let i = index" value="{{categorie.titre}}">
              {{categorie.titre}}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="title">Nom : </label>
          <input type="text" id="title" class="form-control" placeholder="Nom" formControlName="title">
        </div>
      </div>

      <button [disabled]="saveForm.invalid" class="btn btn-success"
              type="submit">Ajouter
      </button>
    </form>
  </div>
  <!--  Fin formulaire pour creer une tache/categorie -->

  <!--  Debut formulaire pour modifier une tache -->
  <div *ngIf="edited" class="input-group">
    <form [formGroup]="editForm" (ngSubmit)="onEdit(editTache)">
      <div class="form-row">

        <div *ngIf="editTache.parent === -1">
          <div class="form-group col">
            <label for="typeTache">Ajouter à une </label>
            <select class="form-control" name="typeTache" id="typeTache" formControlName="typeTache" #tt>
              <option value="tache"> tache </option>
              <option value="newTache"> nouvelle tache </option>
            </select>
          </div>

          <div class="form-group col" *ngIf="tt.value === 'tache'">
            <label for="tacheExistante"> à </label>
            <select class="form-control" name="tacheExistante" id="tacheExistante" formControlName="tacheExistante">
              <option *ngFor="let tache of taches; let i = index" value="{{i}}">
                {{tache.titre}}<!-- de {{categories[tache.parent].titre}}-->
              </option>
            </select>
          </div>

          <div class="form-group col" *ngIf="tt.value === 'newTache'">
            <label for="nveauTitreQuickStart">Nouveau titre</label>
            <input class="form-control" type="text" id="nveauTitreQuickStart" placeholder="Nouveau titre" formControlName="nveauTitreQuickStart">
          </div>

          <div class="form-group col" *ngIf="tt.value === 'newTache'">
            <label for="nvelleCateQuickStart">Déplacer dans la catégorie: </label>
            <select class="form-control" name="nvelleCate" id="nvelleCateQuickStart" formControlName="nvelleCateQuickStart">
              <option *ngFor="let categorie of categories" value="{{categorie.titre}}">
                {{categorie.titre}}
              </option>
            </select>
          </div>
        </div>

        <div class="form-group col" *ngIf="editTache.parent !== -1">
          <label for="nveauTitre">Nouveau titre</label>
          <input class="form-control" type="text" id="nveauTitre" placeholder="Nouveau titre" formControlName="nveauTitre">
        </div>

        <div class="form-group col" *ngIf="editTache.parent !== -1">
          <label for="nvelleCate">Déplacer dans la catégorie: </label>
          <select class="form-control" name="nvelleCate" id="nvelleCate" formControlName="nvelleCate">
            <option *ngFor="let categorie of categories" value="{{categorie.titre}}">
              {{categorie.titre}}
            </option>
          </select>
        </div>

      </div>

      <button [disabled]="editForm.invalid" class="btn btn-success"
              type="submit">Modifier
      </button>
    </form>
  </div>
  <!--  Fin formulaire pour modifier une tache -->

  <!--  Debut liste des taches -->
  <ul class="list-group">
    <!--  Debut liste des taches lancees -->
    <li class="list-group-item" *ngFor="let tache of getTachesDemaree(); let i = index">
      <span>
        <span (click)="demarerStopperTache(tache)">
          <i class="fa fa-lg" [ngClass]="tache.estDemaree ? 'fa-pause-circle-o' : 'fa-play-circle-o'"></i>
        </span>

        {{tache.titre}} {{tempsDynamiqueTache(tache)}}

        <span (click)="supprimerTache(tache)">
          <i class="fa fa-remove"></i>
        </span>
      </span>
    </li>
    <!--  Fin de la liste des taches lancees -->

    <!--  Debut de la liste des taches classees par categorie -->
    <li class="list-group-item" *ngFor="let categorie of categories; let i = index" >

      <span (click)="showTacheOfCategorie(i)">
        <i class="fa fa-lg" [ngClass]="showChildren[i] ? 'fas fa-minus' : 'fas fa-plus'"></i>
      </span>
      {{categorie.titre}} {{tempsCategorie(categorie)}}
      <span (click)="supprimerCategorie(categorie)" *ngIf="i > 1">
        <i class="fa fa-remove"></i>
      </span>

      <!--  Debut liste des taches d'une categorie -->
      <ul *ngIf="showChildren[i] && i == 0">
        <li class="list-group-item" *ngFor="let tache of getTachesWithoutParent(); let j = index">
          <span>
            <span (click)="demarerStopperTache(tache)">
              <i class="fa fa-lg" [ngClass]="tache.estDemaree ? 'fa-pause-circle-o' : 'fa-play-circle-o'"></i>
            </span>

            {{tache.titre}} {{tempsDynamiqueTache(tache)}}

            <span (click)="modifierTache(tache)">
              <i class="fa fa-edit"></i>
            </span>

            <span (click)="supprimerTache(tache)">
              <i class="fa fa-remove"></i>
            </span>
          </span>
        </li>

        <li class="list-group-item" *ngFor="let categorie of categories | slice : 1; let j = index" >
          {{categorie.titre}}
          <ul *ngFor="let tache of getCategorieChildren(getCategorieIdByName(categorie.titre))">
            <li class="list-group-item">
              <span>
                <span (click)="demarerStopperTache(tache)">
                  <i class="fa fa-lg" [ngClass]="tache.estDemaree ? 'fa-pause-circle-o' : 'fa-play-circle-o'"></i>
                </span>

                {{tache.titre}} {{tempsDynamiqueTache(tache)}}

                <span (click)="modifierTache(tache)">
                  <i class="fa fa-edit"></i>
                </span>

                <span (click)="supprimerTache(tache)">
                  <i class="fa fa-remove"></i>
                </span>
              </span>
            </li>
          </ul>
        </li>
      </ul>
      <!--  Fin de la liste des taches d'une categorie -->

      <ul *ngIf="showChildren[i] && i > 0">

        <li class="list-group-item" *ngFor="let tache of getCategorieChildren(getCategorieIdByName(categorie.titre)); let j = index">

          <span>
            <span (click)="demarerStopperTache(tache)">
              <i class="fa fa-lg" [ngClass]="tache.estDemaree ? 'fa-pause-circle-o' : 'fa-play-circle-o'"></i>
            </span>

            {{tache.titre}} {{tempsDynamiqueTache(tache)}}

            <span (click)="modifierTache(tache)">
              <i class="fa fa-edit"></i>
            </span>

            <span (click)="supprimerTache(tache)">
              <i class="fa fa-remove"></i>
            </span>
          </span>

        </li>
      </ul>

    </li>
    <!--  Fin de la liste des taches classees par categorie -->

  </ul>

</div>
